{% extends "layout.html "%}
{% block content %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/summary.css') }}">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">

    <div class="page-wrap">
        <!-- TODO remove last attendee comma-->
        <img class="logo" type = "image" height="200" width="375" src= "{{ url_for('static',filename='img/offroad.png') }}">
        <h1>{{dic['adventure']['name']}}</h1>
        <p class="host_info">Host: {{dic['host']['first_name']}} {{ dic['host']['last_name'] }} on {{ dic['adventure']['date'].strftime('%Y-%m-%d') }}</p>

            <h5>

                {% set alist = [] %}

                {% for i in dic['attendees']%}

                    <!-- Prevents the append from printing None-->

                    {{ alist.append(i['first_name'] + ' ' + i['last_name']) if alist.append(i['first_name'] + ' ' + i['last_name'])}}

                {% endfor %}

                <!-- Prints the attendees by separating them by commas-->

                Attendees: {{ ', '.join(alist) }}

            </h5>



        </h3>

        <br>

        <h4>Restaurants</h4>

        {% for i in dic['restaurants']%}

            <p>{{i['name']}}</p>

            <p>{{i['street']}}, {{i['city']}}, {{i['state']}} {{i['zipcode']}}, {{i['country']}} </p>

            <br>

        {% endfor %}



        <form method="POST" action="" enctype="multipart/form-data">

            {{ form.hidden_tag() }}

            <fieldset class="form-group">

                <legend class="border-bottom mb-4">Create a new post.</legend>

                <div class="form-group">

                    {% if form.content.errors %}

                        {{ form.content(class="form-control form-control-lg is-invalid") }}

                        <div class="invalid-feedback">

                            {% for error in form.content.errors %}

                                <span>{{ error }}</span>

                            {% endfor %}

                        </div>

                    {% else %}

                        {{ form.content(class="form-control form-control-lg") }}

                    {% endif %}

                </div>

                <div class="form-group">

                    {{ form.comment_pic.label() }}

                    {{ form.comment_pic(class="form-control-file") }}

                    {% if form.comment_pic.errors %}

                        {% for error in form.comment_pic.errors %}

                            <span class="text-danger">{{ error }}</span></br>

                        {% endfor %}

                    {% endif %}

                </div>

            </fieldset>

            <div class="form-group">

                {{ form.submit(class="btn btn-outline-info") }}

            </div>

        </form>



        <h4>Comments</h4>

        {% for i in dic['comments'] %}

            <div class="comments-container">


                <ul id="comments-list" class="comments-list">
                    <li>
                        <div class="comment-main-level">
                            <!-- Avatar -->
                            <div class="comment-avatar">
                                <img src="{{ url_for('static', filename='profile_pics/' + i['profile_pic']) }}">
                            </div>
                            <!-- Comment Contents -->
                            <div class="comment-box">
                                <div class="comment-head">
                                    <h6 class="comment-name by-author">{{dic['host']['first_name']}} {{ dic['host']['last_name'] }}</h6>
                                    <span>{{ i['date'].strftime('%I:%M %p - %m/%d/%Y') }}</span>
                                    <i class="fa fa-reply"></i>
                                </div>
                            </div>
                        </div>
                        <div class="comment-content">
                            {{ i['content']}}

                            {% if i['content_photo'] %}
                                <img src="{{ url_for('static', filename='comment_pics/' + i['content_photo']) }}" class="img-fluid">
                            {% endif %}
                            <br>
                        </div>

                        <div class="comment-main-level">
                            <!-- Avatar -->
                            <div class="comment-avatar">
                                <img src="{{ url_for('static', filename='profile_pics/' + i['profile_pic']) }}">
                            </div>
                            <!-- Comment Contents -->
                            <div class="comment-box">
                                <div class="comment-head">
                                    <h6 class="comment-name"> {{i['first_name']}} {{ i['last_name']}} </h6>
                                    <span>{{ i['date'].strftime('%I:%M %p - %m/%d/%Y') }}</span>
                                    <i class="fa fa-reply"></i>
                                </div>
                            </div>
                        </div>
                        <div class="comment-content">
                            {{ i['content']}}

                            {% if i['content_photo'] %}
                                <img src="{{ url_for('static', filename='comment_pics/' + i['content_photo']) }}" class="img-fluid">
                            {% endif %}
                            <br>
                        </div>
                    </li>
                </ul>
            </div>
        {% endfor %}
        {% for page_num in dic['pages'] %}
            {%  if page_num %}
                {%  if dic['curr_page'] == page_num %}
                    <a class="btn btn-info mb-4" href="{{ url_for('summary', adv_id=dic['adventure']['id'], page=page_num) }}">{{ page_num }}</a>
                {% else %}
                    <a class="btn btn-outline-info mb-4" href="{{ url_for('summary', adv_id=dic['adventure']['id'], page=page_num) }}">{{ page_num }}</a>
                {% endif %}
            {% else %}
                ...
            {% endif %}
        {% endfor %}
    </div>
{% endblock content %}